<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Giving Fucks</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <!-- Compiled and minified CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
  </head>
  <body>
    <section id="section1">
      <header id="welcome" class="center-align" style="margin-top: 10%; margin-bottom: 0%;">
        <h4>Are you the next greatest fuck giver?</h4>
      </header>
      <div class="center-align" style="margin-top: 10%;">
        <span class="col s12 l4">
          <button
            class="btn-large black darken-2 z-depth-0 modal-trigger"
            style="display:none; margin-right: 1%; margin-top: 2vh;"
            data-target="modal-login"
            id="login">
            Login
          </button>
        </span>
        <span class="col s12 l4">
          <button
            class="btn-large black darken-2 z-depth-0 col s12 l4"
            id="logout"
            style="display:none; margin-right: 1%; margin-top: 2vh;">
            Logout
          </button>
        </span>
        <span>
          <button
            class="btn-large black darken-2 z-depth-0 modal-trigger col s12 l4"
            style="display:none; margin-right: 1%; margin-top: 2vh;"
            data-target="modal-signup"
            id="signup"
          >
            Signup
          </button>
        </span>
        <span>
          <button
            class="btn-large black darken-2 z-depth-0 "
            id="guest"
            style="display:none; margin-right: 1%; margin-top: 2vh;"
          >
            Continue as Guest
          </button>
        </span>
      </div>

      <!-- SIGN UP MODAL -->
      <div id="modal-signup" class="modal">
        <div class="modal-content">
          <h4>Sign up</h4>
          <br />
          <form id="signup-form">
            <div class="input-field">
              <input type="email" id="signup-email" required />
              <label for="signup-email">Email address</label>
            </div>
            <div class="input-field">
              <input type="password" id="signup-password" required />
              <label for="signup-password">Choose password</label>
            </div>
            <div class="input-field">
              <input type="text" id="signup-bio" required />
              <label for="signup-bio">Your name</label>
            </div>
            <button class="btn black darken-2 z-depth-0" id="googleSignIn">Sign in with Google</button>
            <button class="btn black darken-2 z-depth-0">Sign up</button>
            <p class="error pink-text center-align"></p>
          </form>
        </div>
      </div>

      <!-- LOGIN MODAL -->
      <div id="modal-login" class="modal">
        <div class="modal-content">
          <h4>Login</h4>
          <br />
          <form id="login-form">
            <div class="input-field">
              <input type="email" id="login-email" required />
              <label for="login-email">Email address</label>
            </div>
            <div class="input-field">
              <input type="password" id="login-password" required />
              <label for="login-password">Your password</label>
            </div>
            <button class="btn black darken-2 z-depth-0">Login</button>
            <button
                class="btn black darken-2 z-depth-0 modal-trigger col s12 l4"
                data-target="modal-signup">
                Signup </button>
            <p class="error pink-text center-align"></p>
          </form>
        </div>
      </div>

     

      <!-- ASK LOGIN MODAL -->
      
      <div id="modal-asklogin" class="modal" style="min-width: 320px;">
        <div class="modal-content">
          <div id="asklogin-instruct">
        
        </div>
          <div id="asklogin-fuckStatus"></div>
          <br />
          <div class="center-align">
            <!--
            <button
              class="btn-large black darken-2 z-depth-0"
              style="margin-top: 2vh;"
              id="yeah"
            >
              Login
            </button>
-->
            <button
              class="btn-large black darken-2 z-depth-0"
              style="margin-top: 2vh; padding-left: 1vw; padding-right: 1vw; min-width: 289px;"
              id="moreFucks"
            >
              
            </button>
            <button
              class="btn-large black darken-2 z-depth-0"
              style="margin-top: 2vh;"
              id="nah"
            >
              Nah
            </button>
          </div>
        </div>
      </div>


      <!-- Ask payment modal-->
      <div id="modal-fuckPayment" class="modal">
        <div class="modal-content">
          <div id="header-fuckPayment">
          </div>
          <header id="whatU"></header>
          <br />
          <div
            id="paypal-button-container"
            style="width: 10vw; margin-top: 2vh; text-align: center; "
          ></div>
        </div>
      </div>
    </section>

    <section id="section2">
      <form>
        <div class="row" style="margin-top:20%;">
            <div class="center-align">
                <label
                  class="active"
                  for="fieldInput-premium"
                  id="labelInput"
                  style="font-size: 2.7vw; display: block;"
                  >What would you like to give?</label
                >
            <div class="input-field">   
              <input
                id="fieldInput-premium"
                type="text"
                autocomplete="off"
                placeholder="good shit only.."
              />
             </div>
            </div>
        </div>
            <div class="center-align" style="margin-top: 2vh;">
              <button
                class="btn-large black darken-2 z-depth-0"
                id="fuckButton"
                style="display: inline;"
              >
                fuck
              </button>
            <!--  <button
                class="btn-large black darken-2 z-depth-0"
                id="loveButton"
                style="display: none;"
              >
                love
              </button>-->
            </div>
      </div>
      </form>
    </section>
    <section id="section3">   
</section>
   
  

    <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.2/firebase-firestore.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyARN_48vH28jpHXFfBvxiNfnYE6I1RkGTE",
        authDomain: "giving-fucks.firebaseapp.com",
        databaseURL: "https://giving-fucks.firebaseio.com",
        projectId: "giving-fucks",
        storageBucket: "",
        messagingSenderId: "145183730410"
      };
      firebase.initializeApp(config);
      const auth = firebase.auth();
      const db = firebase.firestore();
      
      document.getElementById("googleSignIn").addEventListener("click", function() {
          // Initialize Google sign-in
      var provider = new firebase.auth.GoogleAuthProvider();
      firebase.auth().signInWithPopup(provider).then(function(result) {
       // This gives you a Google Access Token. You can use it to access the Google API.
      var token = result.credential.accessToken;
      // The signed-in user info.
      var user = result.user;
      const usersRef = db.collection('users').doc(user.uid);

      usersRef.get()
        .then((docSnapshot) => {
          if (!docSnapshot.exists) {
            usersRef.set({
              name: user.displayName,
              fucks: 20
            })
          } 
      });




      }).catch(function(error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // The email of the user's account used.
      var email = error.email;
      // The firebase.auth.AuthCredential type that was used.
      var credential = error.credential;
      // ...
      console.log(errorCode);
      console.log(errorMessage);
      });
      });
    </script>
    <script type="text/javascript">
      //global variables
      var text = "";
      var idNumber = 2;
    </script>
    <script type="text/javascript" src="./setPosition.js"></script>
    <script type="text/javascript" src="./addLove.js"></script>
    <script type="text/javascript" src="./takeUserInput.js"></script>
    <script type="text/javascript" src="./homeScreen.js"></script>
    <script type="text/javascript" src="./restart.js"></script>
    <script type="text/javascript" src="./leaderboard.js"></script>
    <script type="text/javascript" src="./fuckPayment.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.js"></script>
    <script>
      $(document).ready(function() {
        $(".scrollspy").scrollSpy();
      });
    </script>
    <script src="https://www.paypal.com/sdk/js?client-id=AaUC36PZru6KSWA3FJ9ITTwedFUgKh6KRD-pugBy2EkT3eNfFHG-IO7Yln6HRZBtCwmXEI5VwAPGu0Y2"></script>

    <script>
      paypal
        .Buttons({
          style: {
            layout: "vertical",
            color: "silver",
            shape: "rect",
            label: "paypal",
            height: 45
          },
          createOrder: function(data, actions) {
            return actions.order.create({
              purchase_units: [
                {
                  amount: {
                    value: "1.00",
                    currency: "USD"
                  }
                }
              ]
            });
          },
          onApprove: function(data, actions) {
            // Capture the funds from the transaction
            return actions.order.capture().then(function(details) {
              // update their fucks in their db
                db.collection("users").doc(userCred.uid).get().then(function(doc) {
                  if (doc.exists) {
                    var updatedFucks = doc.data().fucks + 20
                      console.log("currentFucks:", updatedFucks);
                      db
                      .collection("users")
                      .doc(userCred.uid).update({
                        fucks: updatedFucks
                      })
                  } else {
                      console.log("No such document!");
                  }
              }).catch(function(error) {
                  console.log("Error getting fucks:", error);
              });
              // Show a success message to your buyer
              //paypal.checkout.closeFlow();
              const modal = document.querySelector("#modal-fuckPayment");
              M.Modal.getInstance(modal).close();
              total = total + 20;
              document.getElementById("instruction1").innerHTML =
              `<span class="green-text">Ok, baller, you have 20 more ${text}s now</span>`;
              instructChange1 = idNumber + 1;
              instructChange2 = idNumber + 4;
              instructChange3 = idNumber + 12;
              instructChange4 = idNumber + 18;
            });
          }
        })
        .render("#paypal-button-container");
    </script>
  </body>
</html>
